# PuzzleBID游戏合约测试用例

---

### 测试数据


**管理员团队**

超级管理员地址：`0xD134dd2a3c16Fb12885cd6FDc8a03D4bbe5d7031`

name：`0x4163636f756e74310000000000000000`（对应Account1）


**艺术家**

艺术家ID：`0xe28a246d965078e969553e85d38e4b28`  Zhang Yi Nan

钱包地址：`0xC463a4BF8A57725Ee9Ff23E096f6C395BdB07b73`
`1FBAF18580190E046CD87040E78F23B1DCE5DA342A446BABACBBF4FC6232D33F`


**作品**

作品ID：`0x7a756f70696e67797979000000000000`

艺术家ID：`0xe28a246d965078e969553e85d38e4b28`

碎片数：`6`

开始时间戳：`1543894200`

游戏规则：
玩家首发最大购买数2个，冻结时间2分钟，作品保护时间5分钟，涨价110%，10分钟后降价，降价95%，
[艺术家80%, 平台2%, 奖池18%]，[艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分）]，[游戏完成者80%, 首发购买者10%, 后续其他购买者10%]


**平台**

基金会钱包地址：`0xe95651358BeE7106a206Bb9B61D0BC406c58707a`
`0DF638C6D36869F5F176F8E0D78DBC30B86EC1AED77D5E2EEBBB1E09202C9D9D`


**玩家**

UnionID：`0x38363135323136363839353431000000` （对应8615216689541）
钱包地址：`0xfaCd69A6df3265dDF3F60A868D3B0086feb1597E`
`C0CE0E3587629BFC3E34A4745ADB2AF793DA58FEF5ED0B7327EA6FE8FC037970`

UnionID：`0x38363133373731373339313039000000`（对应8613771739109）


---

### 一、部署合约

部署顺序：Team > Artist > Works > Platform > Player > PuzzleBID

#### 1.1 部署管理员团队合约

选择Team合约，开始部署：
```
Deploy("0xD134dd2a3c16Fb12885cd6FDc8a03D4bbe5d7031") //传入超级管理员钱包地址
//合约地址：0xac1d10cc7c308ed21d5927241ee6b3c8959c41c5
```

#### 1.2 部署艺术家合约

选择Artist合约，开始部署：
```
Deploy("0xac1d10cc7c308ed21d5927241ee6b3c8959c41c5") //传入管理员团队合约地址
//合约地址：0x26faf03df54494b92c0911961d98f2afc7b6b088
```

#### 1.3 部署作品碎片合约

选择Works合约，开始部署：
```
Deploy("0xac1d10cc7c308ed21d5927241ee6b3c8959c41c5","0x26faf03df54494b92c0911961d98f2afc7b6b088") //传入管理员团队、艺术家合约地址
//合约地址：0x7119075b6c15dd9018ce487c6866312e6beaec47
```

#### 1.4 部署平台合约

选择Platform合约，开始部署：
```
Deploy("0xe95651358BeE7106a206Bb9B61D0BC406c58707a","0xac1d10cc7c308ed21d5927241ee6b3c8959c41c5") //传入基金会钱包地址、管理员团队合约地址
//合约地址：0x8fc6a806f2d033b305a7be8dfa08de69a5988e56
```

#### 1.5 部署玩家合约

选择Player合约，开始部署：
```
Deploy("0xac1d10cc7c308ed21d5927241ee6b3c8959c41c5", "0x7119075b6c15dd9018ce487c6866312e6beaec47") //传入管理员团队、作品碎片合约地址
//合约地址：0x2f7233a514aad44a7c2f767e3f768ab7f51e9240
```

#### 1.6 部署游戏主合约

选择PuzzleBID合约，开始部署：
```
Deploy("0xac1d10cc7c308ed21d5927241ee6b3c8959c41c5", "0x8fc6a806f2d033b305a7be8dfa08de69a5988e56","0x26faf03df54494b92c0911961d98f2afc7b6b088","0x7119075b6c15dd9018ce487c6866312e6beaec47","0x2f7233a514aad44a7c2f767e3f768ab7f51e9240") //传入管理员团队、平台、艺术家、作品碎片、玩家合约地址
//合约地址：0xfc2d7940d0056f564c8ff1ad38089c60a2527414
```
---

### 二、开通开发者权限

#### 2.1 超级管理员

为了方便，将超级管理员Account1设成3个身份，在接下来的测试当中，都将以Account1作为主账号进行合约方法的单元测试：

```
addAdmin("0xD134dd2a3c16Fb12885cd6FDc8a03D4bbe5d7031",true,true,"0x4163636f756e74310000000000000000") 
//Account1的hex
```

#### 2.2 开发者

将以上部署好的合约地址，除管理员团队合约地址外，都加入到开发者列表中，以便合约之间具有更新权限，找到Team合约：

```
addAdmin("0x26faf03df54494b92c0911961d98f2afc7b6b088",false,true,"0x61727469737400000000000000000000") //artist
addAdmin("0x7119075b6c15dd9018ce487c6866312e6beaec47",false,true,"0x776f726b730000000000000000000000") //works
addAdmin("0x8fc6a806f2d033b305a7be8dfa08de69a5988e56",false,true,"0x706c6174666f726d0000000000000000") //platform
addAdmin("0x2f7233a514aad44a7c2f767e3f768ab7f51e9240",false,true,"0x706c6179657200000000000000000000") //player
addAdmin("0xfc2d7940d0056f564c8ff1ad38089c60a2527414",false,true,"0x70757a7a6c6562696400000000000000") //puzzlebid
```

---



### 四、艺术家合约测试

#### 4.1 添加艺术家
```
add("0x5a68616e67205969204e616e00000000","0xC463a4BF8A57725Ee9Ff23E096f6C395BdB07b73") //艺术家ID，钱包地址

```

---

### 五、作品碎片合约测试

#### 5.1 添加作品

```
addWorks("0x7a756f70696e67797979000000000000","0x5a68616e67205969204e616e00000000","4","4000000000","1545140460")
//作品ID，艺术家ID，分成4碎片，作品总价为0.000000002ETH，时间戳为2018-12-5 14:00

```


#### 5.2 添加游戏规则
```
configRule("0x7a756f70696e67797979000000000000",2,60,120,110,300,95,[80, 2, 18],[10, 2, 65],[80, 10, 10])
//作品ID，玩家首发最大购买数2个，冻结时间1分钟，作品保护时间2分钟，涨价110%，5分钟后降价，降价95%，
[艺术家80%, 平台2%, 奖池18%]，[艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分）]，[游戏完成者80%, 首发购买者10%, 后续其他购买者10%]
```

#### 5.3 开启作品游戏

```
publish("0x7a756f70696e67797979000000000000","1545140520") //发布作品游戏
```

#### 5.4 买买买

欧阳
UnionID：`0x38363135323136363839353431000000` （对应8615216689541）
钱包地址：`0x707ada86D20678AFBC23eA90040C7BA724cd6611`
`ACA4F3474B8DB45A42951466801C694B9214DF0991CC08C198A04635AC8CE8A9`

1、欧阳买1#

切换钱包账号
"0x7a756f70696e67797979000000000000",1,"0x38363135323136363839353431000000","0x38363137383339393036323338000000"
1000000000

---
艺术家80%, 平台2%, 奖池18%

艺术家：1000000000 * 80% = 800000000
平台基金会：1000000000 * 2% = 20000000
奖池：1000000000 * 18% = 180000000
---

2、欧阳买2#

切换钱包账号
"0x7a756f70696e67797979000000000000", 2, "0x38363135323136363839353431000000", "0x38363137383339393036323338000000"
1000000000

---
艺术家80%, 平台2%, 奖池18%

艺术家：1000000000 * 80% = 800000000
平台基金会：1000000000 * 2% = 20000000
奖池：1000000000 * 18% = 180000000
---


丁恒  
UnionID：`0x38363133373731373339313039000000`（对应8613771739109）
钱包地址：`0xfaCd69A6df3265dDF3F60A868D3B0086feb1597E`
`C0CE0E3587629BFC3E34A4745ADB2AF793DA58FEF5ED0B7327EA6FE8FC037970`

3、丁恒买3#

切换钱包账号
"0x7a756f70696e67797979000000000000", 3, "0x38363133373731373339313039000000", "0x38363137383339393036323338000000"
1000000000

---
艺术家80%, 平台2%, 奖池18%

艺术家：1000000000 * 80% = 800000000
平台基金会：1000000000 * 2% = 20000000
奖池：1000000000 * 18% = 180000000
---

4、丁恒买4#

切换钱包账号
"0x7a756f70696e67797979000000000000", 4, "0x38363133373731373339313039000000", "0x38363137383339393036323338000000"
1000000000

---
艺术家80%, 平台2%, 奖池18%

艺术家：1000000000 * 80% = 800000000
平台基金会：1000000000 * 2% = 20000000
奖池：1000000000 * 18% = 180000000
---

5、丁恒抢1#（等降价，超过5分钟）

切换钱包账号
"0x7a756f70696e67797979000000000000", 1, "0x38363133373731373339313039000000", "0x38363137383339393036323338000000"
1045000000

---
艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分），剩余归上家

平台基金会：1000000000 * 110% * 95% * 2% = 20900000
24100000
艺术家：（1045000000 - 20900000 - 1000000000）* 10% = 2410000
奖池：（1045000000 - 20900000 - 1000000000） * 65% = 15665000
剩余给上一家（欧阳）：1045000000 - 20900000 - 2410000 - 15665000 = 1006025000
---

6、欧阳抢1#

切换钱包账号
"0x7a756f70696e67797979000000000000", 1, "0x38363135323136363839353431000000", "0x38363137383339393036323338000000"
1149500000

---
艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分），剩余归上家

平台基金会：1149500000 * 2% = 22990000
81510000
艺术家：（1149500000 - 22990000 - 1045000000）* 10% = 8151000
奖池：（1149500000 - 22990000 - 1045000000）* 65% = 52981500
剩余给上一家（丁恒）：1149500000 - 22990000 - 8151000 - 52981500 = 1065377500
---

7、欧阳抢3#

切换钱包账号
"0x7a756f70696e67797979000000000000", 3, "0x38363135323136363839353431000000", "0x38363137383339393036323338000000"
1100000000

---
艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分），剩余归上家

平台基金会：1100000000 * 2% = 22000000
78000000
艺术家：（1100000000 - 22000000 - 1000000000）* 10% = 7800000
奖池：（1100000000 - 22000000 - 1000000000）* 65% = 50700000
剩余给上一家（丁恒）：1100000000 - 22000000 - 7800000 - 50700000 = 1019500000
---



8、欧阳抢4#（完成游戏）

切换钱包账号
"0x7a756f70696e67797979000000000000", 4, "0x38363135323136363839353431000000", "0x38363137383339393036323338000000"
1100000000

---
艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分），剩余归上家

平台基金会：1100000000 * 2% = 22000000
78000000
艺术家：（1100000000 - 22000000 - 1000000000）* 10% = 7800000
奖池：（1100000000 - 22000000 - 1000000000）* 65% = 50700000
剩余给上一家（丁恒）：1100000000 - 22000000 - 7800000 - 50700000 = 1019500000
---


9、结束游戏

---
游戏完成者80%, 首发购买者10%, 后续其他购买者10%
奖池总额：180000000 * 4 + 15665000 + 52981500 + 50700000 + 50700000 = 890046500

欧阳（游戏完成者）：890046500 * 80% = 712037200
首发：
     欧阳：（890046500 * 10%）* （1000000000 * 2 / 4000000000）= 44502325
     丁恒：（890046500 * 10%）* （1000000000 * 2 / 4000000000）= 44502325
二次：
     欧阳：（890046500 * 10%）* 3349500000 / 4394500000 = 67839589.2991239
     丁恒：（890046500 * 10%）* 1045000000 / 4394500000 = 21165060.7008761
---

4394500000 = 1045000000 + 1149500000 + 1100000000 + 1100000000
89004650 = 890046500 * 10%
3349500000  = 1149500000 + 1100000000 + 1100000000



















