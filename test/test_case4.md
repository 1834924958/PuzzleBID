# PuzzleBID游戏合约完整测试用例

---

### 测试数据


**管理员团队**

超级管理员地址：`0xD134dd2a3c16Fb12885cd6FDc8a03D4bbe5d7031`

name：`0x4163636f756e74310000000000000000`（对应Account1）


**艺术家**

艺术家ID：`0xe28a246d965078e969553e85d38e4b28`  Zhang Yi Nan

钱包地址：`0xC463a4BF8A57725Ee9Ff23E096f6C395BdB07b73`

`1FBAF18580190E046CD87040E78F23B1DCE5DA342A446BABACBBF4FC6232D33F`


**作品**

作品ID：`0x7a756f70696e67313233343536000000`

艺术家ID：`0xe28a246d965078e969553e85d38e4b28`

碎片数：`6`

开始时间戳：`1545151200`

游戏规则：

玩家首发最大购买数2个，冻结时间1分钟，作品保护时间2分钟，涨价110%，20分钟后降价，先涨110%再降价95%，
[艺术家80%, 平台2%, 奖池18%]，[艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分）]，[游戏完成者80%, 首发购买者10%, 后续其他购买者10%]


**平台**

基金会钱包地址：`0xe95651358BeE7106a206Bb9B61D0BC406c58707a`

`0DF638C6D36869F5F176F8E0D78DBC30B86EC1AED77D5E2EEBBB1E09202C9D9D`


**玩家**

欧阳

UnionID：`0x38363135323136363839353431000000` （对应8615216689541）

钱包地址：`0x707ada86D20678AFBC23eA90040C7BA724cd6611`

`ACA4F3474B8DB45A42951466801C694B9214DF0991CC08C198A04635AC8CE8A9`

辉哥

UnionID：`0x38363133363731393237373434000000` （对应8613671927744）

钱包地址：`0xA6464fCE1384318Cf979a84A1Bc204E0F3F149d6`

`CCB5075DD5270579F30E5D1A146585554214E4E4717ABE1D89AE88860B3FF649`

丁恒 
UnionID：`0x38363137383339393036323338000000`（对应8617839906238）

钱包地址：`0xfaCd69A6df3265dDF3F60A868D3B0086feb1597E`

`C0CE0E3587629BFC3E34A4745ADB2AF793DA58FEF5ED0B7327EA6FE8FC037970`


---

### 一、部署合约

部署顺序：Team > Artist > Works > Platform > Player > PuzzleBID

#### 1.1 部署管理员团队合约

选择Team合约，开始部署：

```
Deploy("0xD134dd2a3c16Fb12885cd6FDc8a03D4bbe5d7031") //传入超级管理员钱包地址
//合约地址：0xac1d10cc7c308ed21d5927241ee6b3c8959c41c5
```

#### 1.2 部署艺术家合约

选择Artist合约，开始部署：

```
Deploy("0xac1d10cc7c308ed21d5927241ee6b3c8959c41c5") //传入管理员团队合约地址
//合约地址：0x26faf03df54494b92c0911961d98f2afc7b6b088
```

#### 1.3 部署作品碎片合约

选择Works合约，开始部署：

```
Deploy("0xac1d10cc7c308ed21d5927241ee6b3c8959c41c5","0x26faf03df54494b92c0911961d98f2afc7b6b088") //传入管理员团队、艺术家合约地址
//合约地址：0x7119075b6c15dd9018ce487c6866312e6beaec47
```

#### 1.4 部署平台合约

选择Platform合约，开始部署：

```
Deploy("0xe95651358BeE7106a206Bb9B61D0BC406c58707a","0xac1d10cc7c308ed21d5927241ee6b3c8959c41c5") //传入基金会钱包地址、管理员团队合约地址
//合约地址：0x8fc6a806f2d033b305a7be8dfa08de69a5988e56
```

#### 1.5 部署玩家合约

选择Player合约，开始部署：

```
Deploy("0xac1d10cc7c308ed21d5927241ee6b3c8959c41c5", "0x7119075b6c15dd9018ce487c6866312e6beaec47") //传入管理员团队、作品碎片合约地址
//合约地址：0x2f7233a514aad44a7c2f767e3f768ab7f51e9240
```

#### 1.6 部署游戏主合约

选择PuzzleBID合约，开始部署：

```
Deploy("0xac1d10cc7c308ed21d5927241ee6b3c8959c41c5", "0x8fc6a806f2d033b305a7be8dfa08de69a5988e56","0x26faf03df54494b92c0911961d98f2afc7b6b088","0x7119075b6c15dd9018ce487c6866312e6beaec47","0x2f7233a514aad44a7c2f767e3f768ab7f51e9240") //传入管理员团队、平台、艺术家、作品碎片、玩家合约地址
//合约地址：0xfc2d7940d0056f564c8ff1ad38089c60a2527414
```

---

### 二、开通开发者权限

#### 2.1 超级管理员

为了方便，将超级管理员Account1设成3个身份，在接下来的测试当中，都将以Account1作为主账号进行合约方法的单元测试：

```
addAdmin("0xD134dd2a3c16Fb12885cd6FDc8a03D4bbe5d7031",true,true,"0x4163636f756e74310000000000000000") 
//Account1的hex
```

#### 2.2 开发者

将以上部署好的合约地址，除管理员团队合约地址外，都加入到开发者列表中，以便合约之间具有更新权限，找到Team合约：

```
addAdmin("0x26faf03df54494b92c0911961d98f2afc7b6b088",false,true,"0x61727469737400000000000000000000") //artist
addAdmin("0x7119075b6c15dd9018ce487c6866312e6beaec47",false,true,"0x776f726b730000000000000000000000") //works
addAdmin("0x8fc6a806f2d033b305a7be8dfa08de69a5988e56",false,true,"0x706c6174666f726d0000000000000000") //platform
addAdmin("0x2f7233a514aad44a7c2f767e3f768ab7f51e9240",false,true,"0x706c6179657200000000000000000000") //player
addAdmin("0xfc2d7940d0056f564c8ff1ad38089c60a2527414",false,true,"0x70757a7a6c6562696400000000000000") //puzzlebid
```


### 三、艺术家合约测试

#### 3.1 添加艺术家

```
add("0x5a68616e67205969204e616e00000000","0xC463a4BF8A57725Ee9Ff23E096f6C395BdB07b73") //艺术家ID，钱包地址

```

### 四、作品碎片合约测试

#### 4.1 添加作品

```
addWorks("0x7a756f70696e67313233343536000000","0x5a68616e67205969204e616e00000000","6","6000000000","1545202500")
//作品ID，艺术家ID，分成6碎片，作品总价为0.000000006ETH，时间戳为2018-12-19 14:55

```

#### 4.2 添加游戏规则

```
configRule("0x7a756f70696e67313233343536000000",2,60,120,110,600,95,[80, 2, 18],[10, 2, 65],[80, 10, 10])
//作品ID，玩家首发最大购买数2个，冻结时间1分钟，作品保护时间2分钟，涨价110%，10分钟后降价，先涨价110%再降价95%，
[艺术家80%, 平台2%, 奖池18%]，[艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分）]，[游戏完成者80%, 首发购买者10%, 后续其他购买者10%]
```

#### 4.3 开启作品游戏

```
publish("0x7a756f70696e67313233343536000000","1545202500") //发布作品游戏
```

### 五、主合约测试（开始游戏）


玩家一：欧阳

UnionID：`0x38363135323136363839353431000000` （对应8615216689541）

钱包地址：`0x707ada86D20678AFBC23eA90040C7BA724cd6611`

`ACA4F3474B8DB45A42951466801C694B9214DF0991CC08C198A04635AC8CE8A9`

#### 5.1、欧阳买1#碎片

切换钱包账号

```
"0x7a756f70696e67313233343536000000",1,"0x38363135323136363839353431000000","0x38363133373731373339313039000000"
//value = 1000000000
```

核对数据：

艺术家80%, 平台2%, 奖池18%

艺术家：1000000000 * 80% = 800000000

平台基金会：1000000000 * 2% = 20000000

奖池：1000000000 * 18% = 180000000

交易地址：

//TODO

#### 5.2、欧阳买2#碎片

```
"0x7a756f70696e67313233343536000000", 2, "0x38363135323136363839353431000000", "0x38363133373731373339313039000000"
//value = 1000000000
```

核对数据：

艺术家80%, 平台2%, 奖池18%

艺术家：1000000000 * 80% = 800000000

平台基金会：1000000000 * 2% = 20000000

奖池：1000000000 * 18% = 180000000

交易地址：

//TODO

---

玩家二：辉哥

UnionID：`0x38363133363731393237373434000000` （对应8613671927744）

钱包地址：`0xA6464fCE1384318Cf979a84A1Bc204E0F3F149d6`

`CCB5075DD5270579F30E5D1A146585554214E4E4717ABE1D89AE88860B3FF649`

#### 5.3、辉哥买3#碎片

切换钱包账号

```
"0x7a756f70696e67313233343536000000", 3, "0x38363133363731393237373434000000", "0x38363133373731373339313039000000"
//value = 1000000000
```

核对数据：

艺术家80%, 平台2%, 奖池18%

艺术家：1000000000 * 80% = 800000000

平台基金会：1000000000 * 2% = 20000000

奖池：1000000000 * 18% = 180000000

交易地址：

//TODO


#### 5.4、辉哥买4#碎片

```
"0x7a756f70696e67313233343536000000", 4, "0x38363133363731393237373434000000", "0x38363133373731373339313039000000"
//value = 1000000000
```

核对数据：

艺术家80%, 平台2%, 奖池18%

艺术家：1000000000 * 80% = 800000000

平台基金会：1000000000 * 2% = 20000000

奖池：1000000000 * 18% = 180000000

交易地址：

//TODO

---

玩家三：丁恒  

UnionID：`0x38363137383339393036323338000000`（对应8617839906238）

钱包地址：`0xfaCd69A6df3265dDF3F60A868D3B0086feb1597E`

`C0CE0E3587629BFC3E34A4745ADB2AF793DA58FEF5ED0B7327EA6FE8FC037970`


#### 5.5、丁恒买5#碎片

切换钱包账号

```
"0x7a756f70696e67313233343536000000", 5, "0x38363137383339393036323338000000", "0x38363133373731373339313039000000"
//value = 1000000000
```

核对数据：

艺术家80%, 平台2%, 奖池18%

艺术家：1000000000 * 80% = 800000000

平台基金会：1000000000 * 2% = 20000000

奖池：1000000000 * 18% = 180000000

交易地址：

//TODO

#### 5.6、丁恒买6#碎片

```
"0x7a756f70696e67313233343536000000", 6, "0x38363137383339393036323338000000", "0x38363133373731373339313039000000"
//value = 1000000000
```

核对数据：
艺术家80%, 平台2%, 奖池18%

艺术家：1000000000 * 80% = 800000000

平台基金会：1000000000 * 2% = 20000000

奖池：1000000000 * 18% = 180000000

交易地址：

//TODO


#### 5.7、丁恒抢3#碎片

切换钱包账号

```
"0x7a756f70696e67313233343536000000", 3, "0x38363137383339393036323338000000", "0x38363133373731373339313039000000"
//value = 1100000000
```

核对数据：

艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分），剩余归上家

平台基金会：1100000000 * 2% = 22000000

艺术家：（1100000000 - 22000000 - 1000000000）* 10% = 7800000

奖池：（1100000000 - 22000000 - 1000000000） * 65% = 50700000

剩余给上一家（辉哥）：1100000000 - 22000000 - 7800000 - 50700000 = 1019500000

交易地址：

//TODO

---

#### 5.8、辉哥抢5#碎片

切换钱包账号

```
"0x7a756f70696e67313233343536000000", 5, "0x38363133363731393237373434000000", "0x38363133373731373339313039000000"
//value = 1100000000
```

核对数据：

艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分），剩余归上家

平台基金会：1100000000 * 2% = 22000000

艺术家：（1100000000 - 22000000 - 1000000000）* 10% = 7800000

奖池：（1100000000 - 22000000 - 1000000000） * 65% = 50700000

剩余给上一家（丁恒）：1100000000 - 22000000 - 7800000 - 50700000 = 1019500000

交易地址：
//TODO

---

#### 5.9、欧阳抢4#碎片

切换钱包账号

```
"0x7a756f70696e67313233343536000000", 4, "0x38363135323136363839353431000000", "0x38363133373731373339313039000000"
//value = 1100000000
```

核对数据：

艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分），剩余归上家

平台基金会：1100000000 * 2% = 22000000

艺术家：（1100000000 - 22000000 - 1000000000）* 10% = 7800000

奖池：（1100000000 - 22000000 - 1000000000） * 65% = 50700000

剩余给上一家（丁恒）：1100000000 - 22000000 - 7800000 - 50700000 = 1019500000

交易地址：

//TODO

#### 5.10、欧阳抢6#碎片

```
"0x7a756f70696e67313233343536000000", 6, "0x38363135323136363839353431000000", "0x38363133373731373339313039000000"
//value = 1100000000
```

核对数据：

艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分），剩余归上家

平台基金会：1100000000 * 2% = 22000000

艺术家：（1100000000 - 22000000 - 1000000000）* 10% = 7800000

奖池：（1100000000 - 22000000 - 1000000000） * 65% = 50700000

剩余给上一家（丁恒）：1100000000 - 22000000 - 7800000 - 50700000 = 1019500000

交易地址：

//TODO

#### 5.11、欧阳抢3#碎片

```
"0x7a756f70696e67313233343536000000", 3, "0x38363135323136363839353431000000", "0x38363133373731373339313039000000"
//value = 1210000000
```

核对数据：

艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分），剩余归上家

平台基金会：1210000000 * 2% = 24200000

艺术家：（1210000000 - 24200000 - 1100000000）* 10% = 8580000

奖池：（1210000000 - 24200000 - 1100000000）* 65% = 55770000

剩余给上一家（丁恒）：1210000000 - 24200000 - 8580000 - 55770000 = 1121450000

#### 5.12、欧阳抢5#碎片（等降价，超过20分钟）

```
"0x7a756f70696e67313233343536000000", 5, "0x38363135323136363839353431000000", "0x38363133373731373339313039000000"
//value = 1149500000 降价
```

核对数据：

艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分），剩余归上家

平台基金会：1149500000 * 2% = 22990000

艺术家：（1149500000 - 22990000 - 1100000000）* 10% = 2651000

奖池：（1149500000 - 22990000 - 1100000000）* 65% = 17231500

剩余给上一家（辉哥）：1149500000 - 22990000 - 2651000 - 17231500 = 1106627500

#### 5.13、结束游戏

核对数据：

游戏完成者80%, 首发购买者10%, 后续其他购买者10%

奖池总额：180000000 * 6 + 50700000 * 4 + 55770000 + 17231500 = 1355801500

欧阳（游戏完成者）：1355801500 * 80% = 1084641200

首发：

     欧阳：（1355801500 * 10%）* （1000000000 * 2 / 6000000000）= 45193383.33333333

     辉哥：（1355801500 * 10%）* （1000000000 * 2 / 6000000000）= 45193383.33333333

     丁恒：（1355801500 * 10%）* （1000000000 * 2 / 6000000000）= 45193383.33333333

二次：

     欧阳：（1355801500 * 10%）* 4559500000 / 6759500000 = 91453168.71440195

     辉哥：（1355801500 * 10%）* 1100000000 / 6759500000 = 22063490.64279902

     丁恒：（1355801500 * 10%）* 1100000000 / 6759500000 = 22063490.64279902

二次分别投入：

欧阳：1100000000 * 2 + 1210000000 + 1149500000 = 4559500000

辉哥：1100000000

丁恒：1100000000    

最后一笔交易地址：

//TODO

















