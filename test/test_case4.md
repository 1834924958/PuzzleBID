# PuzzleBID游戏合约完整测试用例

---

### 测试数据


**管理员团队**

超级管理员地址：`0xD134dd2a3c16Fb12885cd6FDc8a03D4bbe5d7031`

name：`0x4163636f756e74310000000000000000`（对应Account1）


**艺术家**

艺术家ID：`0xe28a246d965078e969553e85d38e4b28`  Zhang Yi Nan

钱包地址：`0xC463a4BF8A57725Ee9Ff23E096f6C395BdB07b73`

`1FBAF18580190E046CD87040E78F23B1DCE5DA342A446BABACBBF4FC6232D33F`


**作品**

作品ID：`0x7a756f70696e67313233343536000000`

艺术家ID：`0xe28a246d965078e969553e85d38e4b28`

碎片数：`6`

开始时间戳：`1545151200`

游戏规则：

玩家首发最大购买数2个，冻结时间1分钟，作品保护时间2分钟，涨价110%，20分钟后降价，先涨110%再降价95%，
[艺术家80%, 平台2%, 奖池18%]，[艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分）]，[游戏完成者80%, 首发购买者10%, 后续其他购买者10%]


**平台**

基金会钱包地址：`0xe95651358BeE7106a206Bb9B61D0BC406c58707a`

`0DF638C6D36869F5F176F8E0D78DBC30B86EC1AED77D5E2EEBBB1E09202C9D9D`


**玩家**

欧阳

UnionID：`0x38363135323136363839353431000000` （对应8615216689541）

钱包地址：`0x707ada86D20678AFBC23eA90040C7BA724cd6611`

`ACA4F3474B8DB45A42951466801C694B9214DF0991CC08C198A04635AC8CE8A9`

辉哥

UnionID：`0x38363133363731393237373434000000` （对应8613671927744）

钱包地址：`0xA6464fCE1384318Cf979a84A1Bc204E0F3F149d6`

`CCB5075DD5270579F30E5D1A146585554214E4E4717ABE1D89AE88860B3FF649`

丁恒 

UnionID：`0x38363137383339393036323338000000`（对应8617839906238）

钱包地址：`0xfaCd69A6df3265dDF3F60A868D3B0086feb1597E`

`C0CE0E3587629BFC3E34A4745ADB2AF793DA58FEF5ED0B7327EA6FE8FC037970`


---

### 一、部署合约

部署顺序：Team > Artist > Works > Platform > Player > PuzzleBID

#### 1.1 部署管理员团队合约

选择Team合约，开始部署：

```
Deploy("0xD134dd2a3c16Fb12885cd6FDc8a03D4bbe5d7031") //传入超级管理员钱包地址
//合约地址：0x92f81e10af47f40dabc4e9621a9d420f4d1d6760
```

#### 1.2 部署艺术家合约

选择Artist合约，开始部署：

```
Deploy("0x92f81e10af47f40dabc4e9621a9d420f4d1d6760") //传入管理员团队合约地址
//合约地址：0x62705f7cb7f6764886fc3686a356d0f9d5e1005c
```

#### 1.3 部署作品碎片合约

选择Works合约，开始部署：

```
Deploy("0x92f81e10af47f40dabc4e9621a9d420f4d1d6760","0x62705f7cb7f6764886fc3686a356d0f9d5e1005c") //传入管理员团队、艺术家合约地址
//合约地址：0x0d0a56a9d256ea884678469b3f9e07a72d36f8ec
```

#### 1.4 部署平台合约

选择Platform合约，开始部署：

```
Deploy("0xe95651358BeE7106a206Bb9B61D0BC406c58707a","0x92f81e10af47f40dabc4e9621a9d420f4d1d6760") //传入基金会钱包地址、管理员团队合约地址
//合约地址：0xb10d336276471c323b76de045748078bc74a74e1
```

#### 1.5 部署玩家合约

选择Player合约，开始部署：

```
Deploy("0x92f81e10af47f40dabc4e9621a9d420f4d1d6760", "0x0d0a56a9d256ea884678469b3f9e07a72d36f8ec") //传入管理员团队、作品碎片合约地址
//合约地址：0x8684431d9432e1153a42168ae6c0f2808f3dc34d
```

#### 1.6 部署游戏主合约

选择PuzzleBID合约，开始部署：

```
Deploy("0x92f81e10af47f40dabc4e9621a9d420f4d1d6760", "0xb10d336276471c323b76de045748078bc74a74e1","0x62705f7cb7f6764886fc3686a356d0f9d5e1005c","0x0d0a56a9d256ea884678469b3f9e07a72d36f8ec","0x8684431d9432e1153a42168ae6c0f2808f3dc34d") //传入管理员团队、平台、艺术家、作品碎片、玩家合约地址
//合约地址：0xb0c49c62b149425550a58cfc16f3e39616ae7de5
```

---

### 二、开通开发者权限

#### 2.1 超级管理员

为了方便，将超级管理员Account1设成3个身份，在接下来的测试当中，都将以Account1作为主账号进行合约方法的单元测试：

```
addAdmin("0xD134dd2a3c16Fb12885cd6FDc8a03D4bbe5d7031",true,true,"0x4163636f756e74310000000000000000") 
//Account1的hex
```

#### 2.2 开发者

将以上部署好的合约地址，除管理员团队合约地址外，都加入到开发者列表中，以便合约之间具有更新权限，找到Team合约：

```
addAdmin("0x62705f7cb7f6764886fc3686a356d0f9d5e1005c",false,true,"0x61727469737400000000000000000000") //artist
addAdmin("0x0d0a56a9d256ea884678469b3f9e07a72d36f8ec",false,true,"0x776f726b730000000000000000000000") //works
addAdmin("0xb10d336276471c323b76de045748078bc74a74e1",false,true,"0x706c6174666f726d0000000000000000") //platform
addAdmin("0x8684431d9432e1153a42168ae6c0f2808f3dc34d",false,true,"0x706c6179657200000000000000000000") //player
addAdmin("0xb0c49c62b149425550a58cfc16f3e39616ae7de5",false,true,"0x70757a7a6c6562696400000000000000") //puzzlebid
```

---

### 三、艺术家合约测试

#### 3.1 添加艺术家

```
add("0x5a68616e67205969204e616e00000000","0xC463a4BF8A57725Ee9Ff23E096f6C395BdB07b73") //艺术家ID，钱包地址

```

---

### 四、作品碎片合约测试

#### 4.1 添加作品

```
addWorks("0x7a756f70696e67313233343536000000","0x5a68616e67205969204e616e00000000","6","6000000000","1545215100")
//作品ID，艺术家ID，分成6碎片，作品总价为0.000000006ETH，时间戳为2018-12-19 14:55

```

#### 4.2 添加游戏规则

```
configRule("0x7a756f70696e67313233343536000000",2,60,120,110,1200,95,[80, 2, 18],[10, 2, 65],[80, 10, 10])
//作品ID，玩家首发最大购买数2个，冻结时间1分钟，作品保护时间2分钟，涨价110%，20分钟后降价，先涨价110%再降价95%，
[艺术家80%, 平台2%, 奖池18%]，[艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分）]，[游戏完成者80%, 首发购买者10%, 后续其他购买者10%]
```

#### 4.3 开启作品游戏

```
publish("0x7a756f70696e67313233343536000000","1545215400") //发布作品游戏
```

---

### 五、主合约测试（开始游戏）


玩家一：欧阳

UnionID：`0x38363135323136363839353431000000` （对应8615216689541）

钱包地址：`0x707ada86D20678AFBC23eA90040C7BA724cd6611`

`ACA4F3474B8DB45A42951466801C694B9214DF0991CC08C198A04635AC8CE8A9`

#### 5.1、欧阳买1#碎片

切换钱包账号

```
"0x7a756f70696e67313233343536000000",1,"0x38363135323136363839353431000000","0x38363133373731373339313039000000"
//value = 1000000000
```

核对数据：

艺术家80%, 平台2%, 奖池18%

艺术家：1000000000 * 80% = 800000000

平台基金会：1000000000 * 2% = 20000000

奖池：1000000000 * 18% = 180000000

交易地址：

https://ropsten.etherscan.io/tx/0xafade0cd6e25dbfec40494fdb0eb0ba4d46302982739fedbe87eb9829a13c63f

#### 5.2、欧阳买2#碎片

```
"0x7a756f70696e67313233343536000000", 2, "0x38363135323136363839353431000000", "0x38363133373731373339313039000000"
//value = 1000000000
```

核对数据：

艺术家80%, 平台2%, 奖池18%

艺术家：1000000000 * 80% = 800000000

平台基金会：1000000000 * 2% = 20000000

奖池：1000000000 * 18% = 180000000

交易地址：

https://ropsten.etherscan.io/tx/0xf65f723b6bb4a2b187c2c68e7ef9f8a59dde9ff47bc2b25aaea482cda2c850d2

---

玩家二：辉哥

UnionID：`0x38363133363731393237373434000000` （对应8613671927744）

钱包地址：`0xA6464fCE1384318Cf979a84A1Bc204E0F3F149d6`

`CCB5075DD5270579F30E5D1A146585554214E4E4717ABE1D89AE88860B3FF649`

#### 5.3、辉哥买3#碎片

切换钱包账号

```
"0x7a756f70696e67313233343536000000", 3, "0x38363133363731393237373434000000", "0x38363133373731373339313039000000"
//value = 1000000000
```

核对数据：

艺术家80%, 平台2%, 奖池18%

艺术家：1000000000 * 80% = 800000000

平台基金会：1000000000 * 2% = 20000000

奖池：1000000000 * 18% = 180000000

交易地址：

https://ropsten.etherscan.io/tx/0xd175993589af2ce0e38364b472ea6d6f76e6c8289061ae05cc88519dc2db11a4


#### 5.4、辉哥买4#碎片

```
"0x7a756f70696e67313233343536000000", 4, "0x38363133363731393237373434000000", "0x38363133373731373339313039000000"
//value = 1000000000
```

核对数据：

艺术家80%, 平台2%, 奖池18%

艺术家：1000000000 * 80% = 800000000

平台基金会：1000000000 * 2% = 20000000

奖池：1000000000 * 18% = 180000000

交易地址：

https://ropsten.etherscan.io/tx/0x675afa10ebaf98e9d21bd748c41017975235c7981221a5d41fb9649c79d736fb

---

玩家三：丁恒  

UnionID：`0x38363137383339393036323338000000`（对应8617839906238）

钱包地址：`0xfaCd69A6df3265dDF3F60A868D3B0086feb1597E`

`C0CE0E3587629BFC3E34A4745ADB2AF793DA58FEF5ED0B7327EA6FE8FC037970`


#### 5.5、丁恒买5#碎片

切换钱包账号

```
"0x7a756f70696e67313233343536000000", 5, "0x38363137383339393036323338000000", "0x38363133373731373339313039000000"
//value = 1000000000
```

核对数据：

艺术家80%, 平台2%, 奖池18%

艺术家：1000000000 * 80% = 800000000

平台基金会：1000000000 * 2% = 20000000

奖池：1000000000 * 18% = 180000000

交易地址：

https://ropsten.etherscan.io/tx/0x16fbd57cd95f14e4db84ed68db1d4d8a8d7331bcc58f7cc04e08c99010b7c741

#### 5.6、丁恒买6#碎片

```
"0x7a756f70696e67313233343536000000", 6, "0x38363137383339393036323338000000", "0x38363133373731373339313039000000"
//value = 1000000000
```

核对数据：
艺术家80%, 平台2%, 奖池18%

艺术家：1000000000 * 80% = 800000000

平台基金会：1000000000 * 2% = 20000000

奖池：1000000000 * 18% = 180000000

交易地址：

https://ropsten.etherscan.io/tx/0x34ddcfc79df52298df806e6eb6998fcd5045ef5129385f8b524ce90c35dcdbab


#### 5.7、丁恒抢3#碎片

```
"0x7a756f70696e67313233343536000000", 3, "0x38363137383339393036323338000000", "0x38363133373731373339313039000000"
//value = 1100000000
```

核对数据：

艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分），剩余归上家

平台基金会：1100000000 * 2% = 22000000

艺术家：（1100000000 - 22000000 - 1000000000）* 10% = 7800000

奖池：（1100000000 - 22000000 - 1000000000） * 65% = 50700000

剩余给上一家（辉哥）：1100000000 - 22000000 - 7800000 - 50700000 = 1019500000

交易地址：

https://ropsten.etherscan.io/tx/0xad7589c5fc1f578bdcfb4d08a69f065ca0b6d2ab9b8a8ff84a65de93d76694b8

---

#### 5.8、辉哥抢5#碎片

切换钱包账号

```
"0x7a756f70696e67313233343536000000", 5, "0x38363133363731393237373434000000", "0x38363133373731373339313039000000"
//value = 1100000000
```

核对数据：

艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分），剩余归上家

平台基金会：1100000000 * 2% = 22000000

艺术家：（1100000000 - 22000000 - 1000000000）* 10% = 7800000

奖池：（1100000000 - 22000000 - 1000000000） * 65% = 50700000

剩余给上一家（丁恒）：1100000000 - 22000000 - 7800000 - 50700000 = 1019500000

交易地址：

https://ropsten.etherscan.io/tx/0xa13106c09df5c8206448a38b87247500fb35875b590eb6061b8d00ad3ddbf35b

---

#### 5.9、欧阳抢4#碎片

切换钱包账号

```
"0x7a756f70696e67313233343536000000", 4, "0x38363135323136363839353431000000", "0x38363133373731373339313039000000"
//value = 1100000000
```

核对数据：

艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分），剩余归上家

平台基金会：1100000000 * 2% = 22000000

艺术家：（1100000000 - 22000000 - 1000000000）* 10% = 7800000

奖池：（1100000000 - 22000000 - 1000000000） * 65% = 50700000

剩余给上一家（丁恒）：1100000000 - 22000000 - 7800000 - 50700000 = 1019500000

交易地址：

https://ropsten.etherscan.io/tx/0xe925685eb037843abf227ef631f2ab05735b896f566469932f54fa8cfe2e722b

#### 5.10、欧阳抢6#碎片

```
"0x7a756f70696e67313233343536000000", 6, "0x38363135323136363839353431000000", "0x38363133373731373339313039000000"
//value = 1100000000
```

核对数据：

艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分），剩余归上家

平台基金会：1100000000 * 2% = 22000000

艺术家：（1100000000 - 22000000 - 1000000000）* 10% = 7800000

奖池：（1100000000 - 22000000 - 1000000000） * 65% = 50700000

剩余给上一家（丁恒）：1100000000 - 22000000 - 7800000 - 50700000 = 1019500000

交易地址：

https://ropsten.etherscan.io/tx/0x230e8e86ce76f887f76c51a10f3439568e71af9133f4e5eabb697b3c009efa90

#### 5.11、欧阳抢3#碎片

```
"0x7a756f70696e67313233343536000000", 3, "0x38363135323136363839353431000000", "0x38363133373731373339313039000000"
//value = 1210000000
```

核对数据：

艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分），剩余归上家

平台基金会：1210000000 * 2% = 24200000

艺术家：（1210000000 - 24200000 - 1100000000）* 10% = 8580000

奖池：（1210000000 - 24200000 - 1100000000）* 65% = 55770000

剩余给上一家（丁恒）：1210000000 - 24200000 - 8580000 - 55770000 = 1121450000

交易地址：

https://ropsten.etherscan.io/tx/0xd88beda9b131b35320e60dca9bbe9dc3348e775b378ffdeb98918f21d9db145d

#### 5.12、欧阳抢5#碎片（等降价，超过20分钟）

```
"0x7a756f70696e67313233343536000000", 5, "0x38363135323136363839353431000000", "0x38363133373731373339313039000000"
//value = 1149500000 降价
```

核对数据：

艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分），剩余归上家

平台基金会：1149500000 * 2% = 22990000

艺术家：（1149500000 - 22990000 - 1100000000）* 10% = 2651000

奖池：（1149500000 - 22990000 - 1100000000）* 65% = 17231500

剩余给上一家（辉哥）：1149500000 - 22990000 - 2651000 - 17231500 = 1106627500

#### 5.13、结束游戏

核对数据：

游戏完成者80%, 首发购买者10%, 后续其他购买者10%

奖池总额：180000000 * 6 + 50700000 * 4 + 55770000 + 17231500 = 1355801500

欧阳（游戏完成者）：1355801500 * 80% = 1084641200

首发：

     欧阳：（1355801500 * 10%）* （1000000000 * 2 / 6000000000）= 45193383.33333333

     辉哥：（1355801500 * 10%）* （1000000000 * 2 / 6000000000）= 45193383.33333333

     丁恒：（1355801500 * 10%）* （1000000000 * 2 / 6000000000）= 45193383.33333333

二次：

     欧阳：（1355801500 * 10%）* 4559500000 / 6759500000 = 91453168.71440195

     辉哥：（1355801500 * 10%）* 1100000000 / 6759500000 = 22063490.64279902

     丁恒：（1355801500 * 10%）* 1100000000 / 6759500000 = 22063490.64279902

二次分别投入：

欧阳：1100000000 * 2 + 1210000000 + 1149500000 = 4559500000

辉哥：1100000000

丁恒：1100000000    

最后一笔交易地址：

https://ropsten.etherscan.io/tx/0xa484fcb839b8d8041b46ab956c4c4c23c18b18412919911b41afe62d70efb4aa

















