# PuzzleBID游戏合约测试用例

---

### 测试数据


**管理员团队**

超级管理员地址：`0xD134dd2a3c16Fb12885cd6FDc8a03D4bbe5d7031`

name：`0x4163636f756e74310000000000000000`（对应Account1）


**艺术家**

艺术家ID：`0xe28a246d965078e969553e85d38e4b28`  Zhang Yi Nan

钱包地址：`0xC463a4BF8A57725Ee9Ff23E096f6C395BdB07b73`
`1FBAF18580190E046CD87040E78F23B1DCE5DA342A446BABACBBF4FC6232D33F`


**作品**

作品ID：`0x41323031383131303232303500000000`

艺术家ID：`0xe28a246d965078e969553e85d38e4b28`

碎片数：`6`

开始时间戳：`1543894200`

游戏规则：
玩家首发最大购买数2个，冻结时间2分钟，作品保护时间5分钟，涨价110%，10分钟后降价，降价95%，
[艺术家80%, 平台2%, 奖池18%]，[艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分）]，[游戏完成者80%, 首发购买者10%, 后续其他购买者10%]


**平台**

基金会钱包地址：`0xe95651358BeE7106a206Bb9B61D0BC406c58707a`
`0DF638C6D36869F5F176F8E0D78DBC30B86EC1AED77D5E2EEBBB1E09202C9D9D`


**玩家**

UnionID：`0x38363135323136363839353431000000` （对应8615216689541）
钱包地址：`0xfaCd69A6df3265dDF3F60A868D3B0086feb1597E`
`C0CE0E3587629BFC3E34A4745ADB2AF793DA58FEF5ED0B7327EA6FE8FC037970`

UnionID：`0x38363133373731373339313039000000`（对应8613771739109）


---

### 一、部署合约

部署顺序：Team > Artist > Works > Platform > Player > PuzzleBID

#### 1.1 部署管理员团队合约

选择Team合约，开始部署：
```
Deploy("0xD134dd2a3c16Fb12885cd6FDc8a03D4bbe5d7031") //传入超级管理员钱包地址
//合约地址：0xe05842730a5ba1a69d031393ca4cf047a983d5c2
```

#### 1.2 部署艺术家合约

选择Artist合约，开始部署：
```
Deploy("0xe05842730a5ba1a69d031393ca4cf047a983d5c2") //传入管理员团队合约地址
//合约地址：0x16dfe670977365e3121df19c23b2ab2c0dc66aaa
```

#### 1.3 部署作品碎片合约

选择Works合约，开始部署：
```
Deploy("0xe05842730a5ba1a69d031393ca4cf047a983d5c2","0x16dfe670977365e3121df19c23b2ab2c0dc66aaa") //传入管理员团队、艺术家合约地址
//合约地址：0x4bee9e29da249f9cef7143ce61533ef1961aa956
```

#### 1.4 部署平台合约

选择Platform合约，开始部署：
```
Deploy("0xe95651358BeE7106a206Bb9B61D0BC406c58707a","0xe05842730a5ba1a69d031393ca4cf047a983d5c2") //传入基金会钱包地址、管理员团队合约地址
//合约地址：0x5d69763daa4e9d7815953be3801a090f3f060177
```

#### 1.5 部署玩家合约

选择Player合约，开始部署：
```
Deploy("0xe05842730a5ba1a69d031393ca4cf047a983d5c2", "0x4bee9e29da249f9cef7143ce61533ef1961aa956") //传入管理员团队、作品碎片合约地址
//合约地址：0xff1a9d9ba3fbcb856ecc86a55b931733dbb698df
```

#### 1.6 部署游戏主合约

选择PuzzleBID合约，开始部署：
```
Deploy("0xe05842730a5ba1a69d031393ca4cf047a983d5c2", "0x5d69763daa4e9d7815953be3801a090f3f060177","0x16dfe670977365e3121df19c23b2ab2c0dc66aaa","0x4bee9e29da249f9cef7143ce61533ef1961aa956","0xff1a9d9ba3fbcb856ecc86a55b931733dbb698df") //传入管理员团队、平台、艺术家、作品碎片、玩家合约地址
//合约地址：0x9626a1033e811f9c4b2b48741b3779c8ac1e3d23
```
---

### 二、开通开发者权限

#### 2.1 超级管理员

为了方便，将超级管理员Account1设成3个身份，在接下来的测试当中，都将以Account1作为主账号进行合约方法的单元测试：

```
addAdmin("0xD134dd2a3c16Fb12885cd6FDc8a03D4bbe5d7031",true,true,"0x4163636f756e74310000000000000000") 
//Account1的hex
```

#### 2.2 开发者

将以上部署好的合约地址，除管理员团队合约地址外，都加入到开发者列表中，以便合约之间具有更新权限，找到Team合约：

```
addAdmin("0x16dfe670977365e3121df19c23b2ab2c0dc66aaa",false,true,"0x61727469737400000000000000000000") //artist
addAdmin("0x4bee9e29da249f9cef7143ce61533ef1961aa956",false,true,"0x776f726b730000000000000000000000") //works
addAdmin("0x5d69763daa4e9d7815953be3801a090f3f060177",false,true,"0x706c6174666f726d0000000000000000") //platform
addAdmin("0xff1a9d9ba3fbcb856ecc86a55b931733dbb698df",false,true,"0x706c6179657200000000000000000000") //player
addAdmin("0x9626a1033e811f9c4b2b48741b3779c8ac1e3d23",false,true,"0x70757a7a6c6562696400000000000000") //puzzlebid
```

---



### 四、艺术家合约测试

#### 4.1 添加艺术家
```
add("0x5a68616e67205969204e616e00000000","0xC463a4BF8A57725Ee9Ff23E096f6C395BdB07b73") //艺术家ID，钱包地址

```

---

### 五、作品碎片合约测试

#### 5.1 添加作品

```
addWorks("0x41323031383131303232303500000000","0x5a68616e67205969204e616e00000000","2","2000000000","1545112080")
//作品ID，艺术家ID，分成2碎片，作品总价为0.000000002ETH，时间戳为2018-12-5 14:00

```


#### 5.2 添加游戏规则
```
configRule("0x41323031383131303232303500000000",1,60,60,110,600,95,[80, 2, 18],[10, 2, 65],[80, 10, 10])
//作品ID，玩家首发最大购买数2个，冻结时间1分钟，作品保护时间1分钟，涨价110%，10分钟后降价，降价95%，
[艺术家80%, 平台2%, 奖池18%]，[艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分）]，[游戏完成者80%, 首发购买者10%, 后续其他购买者10%]
```

#### 5.3 开启作品游戏

```
publish("0x41323031383131303232303500000000","1545112200") //发布作品游戏
```

#### 5.4 买买买

欧阳
UnionID：`0x38363135323136363839353431000000` （对应8615216689541）
钱包地址：`0x707ada86D20678AFBC23eA90040C7BA724cd6611`
`ACA4F3474B8DB45A42951466801C694B9214DF0991CC08C198A04635AC8CE8A9`

切换钱包账号
"0x41323031383131303232303500000000", 1, "0x38363135323136363839353431000000", "0x38363137383339393036323338000000"
1000000000
0.000000001
https://ropsten.etherscan.io/tx/0x022c83fc233be73d410e60360a1a6f8765c0709a37b901fc331c7087535b284b

---
艺术家80%, 平台2%, 奖池18%

艺术家：1000000000 * 80% = 800000000
平台基金会：1000000000 * 2% = 20000000
奖池：1000000000 * 18% = 180000000
---


丁恒  
UnionID：`0x38363133373731373339313039000000`（对应8613771739109）
钱包地址：`0xfaCd69A6df3265dDF3F60A868D3B0086feb1597E`
`C0CE0E3587629BFC3E34A4745ADB2AF793DA58FEF5ED0B7327EA6FE8FC037970`

切换钱包账号
"0x41323031383131303232303500000000", 2, "0x38363133373731373339313039000000", "0x38363137383339393036323338000000"
1000000000
https://ropsten.etherscan.io/tx/0x5814fa37af85526ebca4975208ee3bae932af146f4a37457173e0feed67765a7

---
艺术家80%, 平台2%, 奖池18%

平台基金会：1000000000 * 2% = 20000000
艺术家：1000000000 * 80% = 800000000
奖池：1000000000 * 18% = 180000000
---


欧阳

切换钱包账号
"0x41323031383131303232303500000000", 2, "0x38363135323136363839353431000000", "0x38363137383339393036323338000000"
1100000000


---
艺术家10%（溢价部分）, 平台2%（总价）, 奖池65%（溢价部分）

平台基金会：1100000000 * 2% = 22000000
艺术家：（1100000000 - 22000000 - 1000000000）* 10% = 7800000
78000000
奖池：（1100000000 - 22000000 - 1000000000）* 65% = 50700000
剩余给上一家（丁恒）：1100000000 - 22000000 - 7800000 - 50700000 = 1019500000
---


---
游戏完成者80%, 首发购买者10%, 后续其他购买者10%
奖池总额：180000000 + 180000000 + 50700000 = 410700000

欧阳（游戏完成者）：410700000 * 80% = 328560000
首发：
     欧阳：（410700000 * 10%）* （1000000000 / 2000000000）= 20535000
     丁恒：（410700000 * 10%）* （1000000000 / 2000000000）= 20535000
二次：
     欧阳：（410700000 * 10%）* （1000000000 / 1000000000）= 41070000
     丁恒：无
---
https://ropsten.etherscan.io/tx/0xaeaf5b30ead0c87a4b239e36638d6107e899159e878a5d10eb1e8e21135c1a58





















